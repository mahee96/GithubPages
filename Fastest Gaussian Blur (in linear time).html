<!DOCTYPE html>
<!-- saved from url=(0048)http://blog.ivank.net/fastest-gaussian-blur.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0">
	<title>  Fastest Gaussian Blur (in linear time)</title>

	
	<link rel="stylesheet" href="./Fastest Gaussian Blur (in linear time)_files/style.css" type="text/css" media="screen">
	
<script id="twitter-wjs" src="./Fastest Gaussian Blur (in linear time)_files/widgets.js.download"></script><script type="text/javascript" async="" src="./Fastest Gaussian Blur (in linear time)_files/ga.js.download"></script><script type="text/javascript" src="./Fastest Gaussian Blur (in linear time)_files/hl-all.js.download"></script>

	<script type="text/javascript">
		function doIt() {var args = { showWhitespace: false, lineNumbers: false };
		DlHighlight.HELPERS.highlightByName('dlhl', "pre", args); };
		window.onload = doIt;
	</script>

<script type="text/x-mathjax-config;executed=true">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$']]}
});
</script>
<script src="./Fastest Gaussian Blur (in linear time)_files/MathJax.js.download" id=""></script>

	<script>
		function getFlashMovie(movieName) {
			var isIE = navigator.appName.indexOf("Microsoft") != -1;
			return (isIE) ? window[movieName] : document[movieName];
		}
		function mG(o) { getFlashMovie('gd').mG(o.innerHTML); }
		function sendToJavaScript(val)	{ document.getElementById('boxX').value = val;	}
	</script>
	
	<script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-4249565-11']);  _gaq.push(['_trackPageview']);
	  (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();
	</script>
<script type="text/javascript" async="" src="./Fastest Gaussian Blur (in linear time)_files/embed.js.download"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script charset="utf-8" src="./Fastest Gaussian Blur (in linear time)_files/button.cf7aaea83eb75b84ae4508f0ceb5dc4c.js.download"></script><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.5a8b564bebf2a39fcd0c5f0f83e6fddd.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.90a60d500e3de29f162afaa4d877b73a.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.54cf549c270b597d5587d24486b38d71.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><script src="./Fastest Gaussian Blur (in linear time)_files/alfie_v4.63f1ab6d6b9d5807dc0c94ef3fe0b851.js.download" async="" charset="UTF-8"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<div id="page">
	<div id="header"><a href="http://blog.ivank.net/">Algorithms and Stuff</a></div>

	<div id="pagemenu">
		<ul id="page-list" class="clearfix">
			<li class="page_item">
				<a href="http://blog.ivank.net/" title="Home">Home</a>
			</li>
			<li class="page_item page-item-2"><a href="http://blog.ivank.net/about">About</a></li>
		</ul>    
	</div>
<div id="main">
	<div id="content">
			<div class="post" id="post-662">
			<img src="./Fastest Gaussian Blur (in linear time)_files/blur.png" class="thumb"> 
			<h1>Fastest Gaussian Blur (in linear time)</h1>
			<div class="entry">
								<p>I needed a really fast Gaussian blur for one of my projects. After hours of struggling and browsing the internet, I finally found the best solution.</p>
<span id="more-662"></span>
<h2>Beginning</h2>
<p>My solution is based on <a href="http://elynxsdk.free.fr/ext-docs/Blur/Fast_box_blur.pdf">Fast image convolutions</a> by Wojciech Jarosz.
Presented ideas are very simple and I don't know who is the original author. I am going to describe it a little better and add some mathematics.
To get motivated, take a glance at <a href="http://blog.ivank.net/fastest-gaussian-blur.html#results">the results</a>. I have implemented this code into <a href="http://www.photopea.com/">Photopea</a> under Filter - Blur - Gaussian Blur.
</p>

<h2>Definition</h2>

<p>The <a href="http://en.wikipedia.org/wiki/Convolution">convolution</a> of two 2D functions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.639em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.524em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1000.52em, 2.491em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">f</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.466em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.45em, 1000.47em, 2.491em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">g</script> is defined as the volume of product of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 0.639em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.524em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1000.52em, 2.491em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">f</script> and "shifted" <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.466em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.45em, 1000.47em, 2.491em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">g</script>. The second function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.466em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.45em, 1000.47em, 2.491em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 0.906em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">g</script> is sometimes called "weight", since it determines, how much of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 0.639em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.524em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1000.52em, 2.491em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">f</script> will get into the result</p>

<p>The Gaussian blur of a 2D function can be defined as a convolution of that function with 2D <a href="http://en.wikipedia.org/wiki/Gaussian_function">Gaussian function</a>. Our gaussian function has an integral 1 (volume under surface) and is uniquely defined by one parameter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.508em, 1000.58em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">\sigma</script> called standard deviation. We will also call it "radius" in the text below.</p>

<p>In our discrete finite case, we represent our 2D functions as matrices of values. We compute the volume (integral) as a sum. Gaussian function has near to zero values behind some radius, so we will use only the values  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" style="width: 12.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.362em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.334em, 1010.36em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.292em;">≤</span><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic; padding-left: 0.292em;">x</span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.292em;">≤</span><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic; padding-left: 0.292em;">r</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.177em;">−</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.292em;">≤</span><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic; padding-left: 0.292em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.292em;">≤</span><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic; padding-left: 0.292em;">r</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi>r</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>r</mi><mo>,</mo><mo>−</mo><mi>r</mi><mo>≤</mo><mi>y</mi><mo>≤</mo><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">-r \leq x \leq r, -r \leq y \leq r</script>. This "useful" part of weight is also called the <strong>kernel</strong>.The value of convolution at [i, j] is the weighted average, i. e. sum of function values around [i, j] multiplied by weight.</p>

<h2>Algorithm 1</h2>

<p>For a general discrete convolution of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 0.639em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.524em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1000.52em, 2.491em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">f</script> and weight function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-40" style="width: 0.929em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.755em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.45em, 1000.75em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">w</script>, we can compute the result <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 0.524em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.408em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1000.41em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">b</script> as:</p>

<p><big>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" style="width: 17.216em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.323em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.436em, 1014.23em, 3.426em, -999.998em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-55" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.485em;"><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1001.98em, 4.39em, -999.998em); top: -3.132em; left: 0em;"><span class="texatom" id="MathJax-Span-57"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-62" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.11em, 4.197em, -999.998em); top: -4.964em; left: 0.436em;"><span class="texatom" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-67" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="munderover" id="MathJax-Span-69" style="padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 2.124em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.533em;"><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.12em, 4.39em, -999.998em); top: -3.132em; left: 0em;"><span class="texatom" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.16em, 4.294em, -999.998em); top: -5.012em; left: 0.485em;"><span class="texatom" id="MathJax-Span-78"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-81" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-82" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">x</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.243em;">∗</span><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">w</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">x</span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.386em; border-left: 0px solid; width: 0px; height: 3.359em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>=</mo><mi>i</mi><mo>−</mo><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mi>r</mi></mrow></munderover><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mi>j</mi><mo>−</mo><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mi>r</mi></mrow></munderover><mi>f</mi><mo stretchy="false">[</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false">]</mo><mo>∗</mo><mi>w</mi><mo stretchy="false">[</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">b[i,j] = \sum\limits_{y=i-r}^{i+r}  \sum\limits_{x=j-r}^{j+r} f[y,x] * w[y,x]</script>
</big></p>
<p>For gaussian weight, we can compute only weights around [i, j] (area of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-96" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.144em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em, 1002.14em, 2.318em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="mn" id="MathJax-Span-98" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="msubsup" id="MathJax-Span-100" style="padding-left: 0.234em;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.359em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.337em; left: 0.466em;"><span class="mn" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 1.184em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mo>⋅</mo><msup><mi>r</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-13">4 \cdot r^2</script>). When our matrix has <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" style="width: 0.813em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.45em, 1000.64em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">n</script> values, the time complexity is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-106" style="width: 4.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.764em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em, 1003.65em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="msubsup" id="MathJax-Span-112" style="padding-left: 0.234em;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.359em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.337em; left: 0.466em;"><span class="mn" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.462em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><msup><mi>r</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15">O(n \cdot r^2)</script>. For large radii, e. g. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-116" style="width: 3.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.839em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.276em, 1002.78em, 2.318em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main; padding-left: 0.292em;">=</span><span class="mn" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.292em;">10</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>10</mn></math></span></span><script type="math/tex" id="MathJax-Element-16">r = 10</script>, we have to do <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;400&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-121" style="width: 3.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.07em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.276em, 1003.01em, 2.318em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main; padding-left: 0.234em;">∗</span><span class="mn" id="MathJax-Span-125" style="font-family: MathJax_Main; padding-left: 0.234em;">400</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>∗</mo><mn>400</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">n * 400</script> operations, which correspond to 400 loops over the whole matrix and that is ugly.</p>

<pre name="dlhl" class="DlHighlight js"><span class="comment comment-line"><span class="before">//</span> source channel, target channel, width, height, radius</span>
<span class="operand keyword">function</span> <span class="operand defun">gaussBlur_1</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">var</span> <span class="operand">rs</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">ceil</span><span class="paren">(</span><span class="operand">r</span> <span class="operator">*</span> <span class="operand">2</span>.<span class="operand">57</span><span class="paren">)</span>;     <span class="comment comment-line"><span class="before">//</span> significant radius</span>
    <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">h</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span>
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">w</span>; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
            <span class="operand keyword">var</span> <span class="operand">val</span> <span class="operator">=</span> <span class="operand">0</span><span class="comma">,</span> <span class="operand">wsum</span> <span class="operator">=</span> <span class="operand">0</span>;
            <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">iy</span> <span class="operator">=</span> <span class="operand">i</span><span class="operator">-</span><span class="operand">rs</span>; <span class="operand">iy</span><span class="operator">&lt;</span><span class="operand">i</span><span class="operator">+</span><span class="operand">rs</span><span class="operator">+</span><span class="operand">1</span>; <span class="operand">iy</span><span class="operator">++</span><span class="paren">)</span>
                <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">ix</span> <span class="operator">=</span> <span class="operand">j</span><span class="operator">-</span><span class="operand">rs</span>; <span class="operand">ix</span><span class="operator">&lt;</span><span class="operand">j</span><span class="operator">+</span><span class="operand">rs</span><span class="operator">+</span><span class="operand">1</span>; <span class="operand">ix</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
                    <span class="operand keyword">var</span> <span class="operand">x</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">min</span><span class="paren">(</span><span class="operand">w</span><span class="operator">-</span><span class="operand">1</span><span class="comma">,</span> <span class="operand builtin">Math</span>.<span class="operand">max</span><span class="paren">(</span><span class="operand">0</span><span class="comma">,</span> <span class="operand">ix</span><span class="paren">)</span><span class="paren">)</span>;
                    <span class="operand keyword">var</span> <span class="operand">y</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">min</span><span class="paren">(</span><span class="operand">h</span><span class="operator">-</span><span class="operand">1</span><span class="comma">,</span> <span class="operand builtin">Math</span>.<span class="operand">max</span><span class="paren">(</span><span class="operand">0</span><span class="comma">,</span> <span class="operand">iy</span><span class="paren">)</span><span class="paren">)</span>;
                    <span class="operand keyword">var</span> <span class="operand">dsq</span> <span class="operator">=</span> <span class="paren">(</span><span class="operand">ix</span><span class="operator">-</span><span class="operand">j</span><span class="paren">)</span><span class="operator">*</span><span class="paren">(</span><span class="operand">ix</span><span class="operator">-</span><span class="operand">j</span><span class="paren">)</span><span class="operator">+</span><span class="paren">(</span><span class="operand">iy</span><span class="operator">-</span><span class="operand">i</span><span class="paren">)</span><span class="operator">*</span><span class="paren">(</span><span class="operand">iy</span><span class="operator">-</span><span class="operand">i</span><span class="paren">)</span>;
                    <span class="operand keyword">var</span> <span class="operand">wght</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">exp</span><span class="paren">(</span> <span class="operator">-</span><span class="operand">dsq</span> <span class="operator">/</span> <span class="paren">(</span><span class="operand">2</span><span class="operator">*</span><span class="operand">r</span><span class="operator">*</span><span class="operand">r</span><span class="paren">)</span> <span class="paren">)</span> <span class="operator">/</span> <span class="paren">(</span><span class="operand builtin">Math</span>.<span class="operand">PI</span><span class="operator">*</span><span class="operand">2</span><span class="operator">*</span><span class="operand">r</span><span class="operator">*</span><span class="operand">r</span><span class="paren">)</span>;
                    <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">y</span><span class="operator">*</span><span class="operand">w</span><span class="operator">+</span><span class="operand">x</span><span class="paren">]</span> <span class="operator">*</span> <span class="operand">wght</span>;  <span class="operand">wsum</span> <span class="operator">+=</span> <span class="operand">wght</span>;
                <span class="paren">}</span>
            <span class="operand">tcl</span><span class="paren">[</span><span class="operand">i</span><span class="operator">*</span><span class="operand">w</span><span class="operator">+</span><span class="operand">j</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">round</span><span class="paren">(</span><span class="operand">val</span><span class="operator">/</span><span class="operand">wsum</span><span class="paren">)</span>;            
        <span class="paren">}</span>
<span class="paren">}</span></pre>


<h2>Algorithm 2</h2>

<p>Let's introduce the <b>box blur</b>. It is the convolution of function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-126" style="width: 0.639em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.524em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1000.52em, 2.491em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-127"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">f</script> and weight <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-129" style="width: 0.929em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.755em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.45em, 1000.75em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-130"><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">w</script>, but weight is constant and lies within a square (box). The nice property of the box blur is, that several passes (convolutions) with a box blur approximate one pass with a gaussian blur. </p>

<p>In this algorithm, we will simulate the gaussian blur with 3 passes of box blur. Let's denote the half of size of square as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-132" style="width: 1.045em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1000.87em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-133"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">br</script> ("box radius"). The constant value of weight is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" style="width: 5.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.343em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em, 1004.34em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="mn" id="MathJax-Span-138" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-143" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-144" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">b</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">r</span><span class="msubsup" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 0.813em; height: 0px;"><span style="position: absolute; clip: rect(3.07em, 1000.29em, 4.401em, -999.997em); top: -3.99em; left: 0em;"><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.337em; left: 0.408em;"><span class="mn" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.462em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mi>b</mi><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-21">1 / (2 \cdot br)^2</script> (so the sum over the whole weight is 1). We can define box blur as:</p>

<p><big>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-150" style="width: 18.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.432em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.436em, 1015.43em, 3.474em, -999.998em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-160" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 2.317em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.629em;"><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.32em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-167" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-168" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.4em, 4.197em, -999.998em); top: -4.964em; left: 0.436em;"><span class="texatom" id="MathJax-Span-170"><span class="mrow" id="MathJax-Span-171"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="munderover" id="MathJax-Span-176" style="padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 2.413em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.677em;"><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.41em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="mi" id="MathJax-Span-180" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.45em, 4.294em, -999.998em); top: -5.012em; left: 0.485em;"><span class="texatom" id="MathJax-Span-186"><span class="mrow" id="MathJax-Span-187"><span class="mi" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">x</span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-198"><span class="mrow" id="MathJax-Span-199"><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-202" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main; padding-left: 0.243em;">⋅</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">b</span><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math-italic;">r</span><span class="msubsup" id="MathJax-Span-206"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1000.29em, 4.39em, -999.998em); top: -4em; left: 0em;"><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -4.385em; left: 0.388em;"><span class="mn" id="MathJax-Span-208" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.444em; border-left: 0px solid; width: 0px; height: 3.417em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>b</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>=</mo><mi>i</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mi>j</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><mi>f</mi><mo stretchy="false">[</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mi>b</mi><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-22">bb[i,j] = \sum\limits_{y=i-br}^{i+br}  \sum\limits_{x=j-br}^{j+br} f[y,x]  / (2 \cdot br)^2 </script>
</big></p>

<p>We have to convert the standard deviation of gaussian blur <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-209" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.466em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.45em, 1000.47em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-210"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">r</script> into dimensions of boxes for box blur. I am not very good at calculus, but fortunatelly I have found <a href="http://www.csse.uwa.edu.au/~pk/research/matlabfns/#integral">this website</a> and used their implementation.</p>

<pre name="dlhl" class="DlHighlight js"><span class="operand keyword">function</span> <span class="operand defun">boxesForGauss</span><span class="paren">(</span><span class="operand">sigma</span><span class="comma">,</span> <span class="operand">n</span><span class="paren">)</span>  <span class="comment comment-line"><span class="before">//</span> standard deviation, number of boxes</span>
<span class="paren">{</span>
    <span class="operand keyword">var</span> <span class="operand">wIdeal</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">sqrt</span><span class="paren">(</span><span class="paren">(</span><span class="operand">12</span><span class="operator">*</span><span class="operand">sigma</span><span class="operator">*</span><span class="operand">sigma</span><span class="operator">/</span><span class="operand">n</span><span class="paren">)</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span>;  <span class="comment comment-line"><span class="before">//</span> Ideal averaging filter width </span>
    <span class="operand keyword">var</span> <span class="operand">wl</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">floor</span><span class="paren">(</span><span class="operand">wIdeal</span><span class="paren">)</span>;  <span class="operand keyword">if</span><span class="paren">(</span><span class="operand">wl</span><span class="operator">%</span><span class="operand">2</span><span class="operator">==</span><span class="operand">0</span><span class="paren">)</span> <span class="operand">wl</span><span class="operator">--</span>;
    <span class="operand keyword">var</span> <span class="operand">wu</span> <span class="operator">=</span> <span class="operand">wl</span><span class="operator">+</span><span class="operand">2</span>;
				
    <span class="operand keyword">var</span> <span class="operand">mIdeal</span> <span class="operator">=</span> <span class="paren">(</span><span class="operand">12</span><span class="operator">*</span><span class="operand">sigma</span><span class="operator">*</span><span class="operand">sigma</span> <span class="operator">-</span> <span class="operand">n</span><span class="operator">*</span><span class="operand">wl</span><span class="operator">*</span><span class="operand">wl</span> <span class="operator">-</span> <span class="operand">4</span><span class="operator">*</span><span class="operand">n</span><span class="operator">*</span><span class="operand">wl</span> <span class="operator">-</span> <span class="operand">3</span><span class="operator">*</span><span class="operand">n</span><span class="paren">)</span><span class="operator">/</span><span class="paren">(</span><span class="operator">-</span><span class="operand">4</span><span class="operator">*</span><span class="operand">wl</span> <span class="operator">-</span> <span class="operand">4</span><span class="paren">)</span>;
    <span class="operand keyword">var</span> <span class="operand">m</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">round</span><span class="paren">(</span><span class="operand">mIdeal</span><span class="paren">)</span>;
    <span class="comment comment-line"><span class="before">//</span> var sigmaActual = Math.sqrt( (m*wl*wl + (n-m)*wu*wu - n)/12 );</span>
				
    <span class="operand keyword">var</span> <span class="operand">sizes</span> <span class="operator">=</span> <span class="paren">[</span><span class="paren">]</span>;  <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">n</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span> <span class="operand">sizes</span>.<span class="operand">push</span><span class="paren">(</span><span class="operand">i</span><span class="operator">&lt;</span><span class="operand">m</span><span class="operator">?</span><span class="operand">wl</span><span class="operator">:</span><span class="operand">wu</span><span class="paren">)</span>;
    <span class="operand keyword">return</span> <span class="operand">sizes</span>;
<span class="paren">}</span></pre>

<p>Our algorithm has still the same complexity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-212" style="width: 4.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.764em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em, 1003.65em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="msubsup" id="MathJax-Span-218" style="padding-left: 0.234em;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.359em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.337em; left: 0.466em;"><span class="mn" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.462em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><msup><mi>r</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">O(n \cdot r^2)</script>, but it has two advantages: first, the area is much smaller (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-222" style="width: 1.045em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1000.87em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">br</script> is almost equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-226" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.582em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.508em, 1000.58em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-227"><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">\sigma</script>, while significant radius for gaussian is much larger). The second advantage is, that the weight is constant. Even though we have to do it 3 times, it performs faster.</p>

<pre name="dlhl" class="DlHighlight js"><span class="operand keyword">function</span> <span class="operand defun">gaussBlur_2</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">var</span> <span class="operand">bxs</span> <span class="operator">=</span> <span class="operand">boxesForGauss</span><span class="paren">(</span><span class="operand">r</span><span class="comma">,</span> <span class="operand">3</span><span class="paren">)</span>;
    <span class="operand">boxBlur_2</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">0</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
    <span class="operand">boxBlur_2</span> <span class="paren">(</span><span class="operand">tcl</span><span class="comma">,</span> <span class="operand">scl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">1</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
    <span class="operand">boxBlur_2</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">2</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
<span class="paren">}</span>
<span class="operand keyword">function</span> <span class="operand defun">boxBlur_2</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">h</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span>
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">w</span>; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
            <span class="operand keyword">var</span> <span class="operand">val</span> <span class="operator">=</span> <span class="operand">0</span>;
            <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">iy</span><span class="operator">=</span><span class="operand">i</span><span class="operator">-</span><span class="operand">r</span>; <span class="operand">iy</span><span class="operator">&lt;</span><span class="operand">i</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span>; <span class="operand">iy</span><span class="operator">++</span><span class="paren">)</span>
                <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">ix</span><span class="operator">=</span><span class="operand">j</span><span class="operator">-</span><span class="operand">r</span>; <span class="operand">ix</span><span class="operator">&lt;</span><span class="operand">j</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span>; <span class="operand">ix</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
                    <span class="operand keyword">var</span> <span class="operand">x</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">min</span><span class="paren">(</span><span class="operand">w</span><span class="operator">-</span><span class="operand">1</span><span class="comma">,</span> <span class="operand builtin">Math</span>.<span class="operand">max</span><span class="paren">(</span><span class="operand">0</span><span class="comma">,</span> <span class="operand">ix</span><span class="paren">)</span><span class="paren">)</span>;
                    <span class="operand keyword">var</span> <span class="operand">y</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">min</span><span class="paren">(</span><span class="operand">h</span><span class="operator">-</span><span class="operand">1</span><span class="comma">,</span> <span class="operand builtin">Math</span>.<span class="operand">max</span><span class="paren">(</span><span class="operand">0</span><span class="comma">,</span> <span class="operand">iy</span><span class="paren">)</span><span class="paren">)</span>;
                    <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">y</span><span class="operator">*</span><span class="operand">w</span><span class="operator">+</span><span class="operand">x</span><span class="paren">]</span>;
                <span class="paren">}</span>
            <span class="operand">tcl</span><span class="paren">[</span><span class="operand">i</span><span class="operator">*</span><span class="operand">w</span><span class="operator">+</span><span class="operand">j</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand">val</span><span class="operator">/</span><span class="paren">(</span><span class="paren">(</span><span class="operand">r</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span><span class="operator">*</span><span class="paren">(</span><span class="operand">r</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span><span class="paren">)</span>;
        <span class="paren">}</span>
<span class="paren">}</span></pre>

<h2>Algorithm 3</h2>

<p>We have already simplified gaussian blur into 3 passes of box blur. Let's do a little experiment. Let's define a <strong>horizontal blur</strong> and <strong>total blur</strong>:</p>

<p><big>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-229" style="width: 15.142em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.587em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(5.21em, 1012.49em, 11.43em, -999.998em); top: -6.941em; left: 0em;"><span class="mrow" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 12.587em; height: 0px;"><span style="position: absolute; clip: rect(2.269em, 1012.35em, 5.306em, -999.998em); top: -4em; left: 0em;"><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.185em, 1000.44em, 4.149em, -999.998em); top: -4em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.855em; left: 0.436em;"><span class="mi" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-240" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 2.413em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.677em;"><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.41em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-242"><span class="mrow" id="MathJax-Span-243"><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-247" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-248" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.45em, 4.294em, -999.998em); top: -5.012em; left: 0.485em;"><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">x</span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-262"><span class="mrow" id="MathJax-Span-263"><span class="mo" id="MathJax-Span-264" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-266" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main; padding-left: 0.243em;">⋅</span><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">b</span><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(2.269em, 1012.49em, 5.306em, -999.998em); top: -0.817em; left: 0em;"><span class="mspace" id="MathJax-Span-271" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-272"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.185em, 1000.44em, 4.149em, -999.998em); top: -4em; left: 0em;"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.855em; left: 0.436em;"><span class="mi" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-281" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 2.365em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.677em;"><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.37em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-283"><span class="mrow" id="MathJax-Span-284"><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-288" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-289" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-290" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.45em, 4.294em, -999.998em); top: -5.012em; left: 0.436em;"><span class="texatom" id="MathJax-Span-291"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-297" style="padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.185em, 1000.44em, 4.149em, -999.998em); top: -4em; left: 0em;"><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.855em; left: 0.436em;"><span class="mi" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-309" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.243em;">⋅</span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">b</span><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.946em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.262em; border-left: 0px solid; width: 0px; height: 7.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mi>j</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><mi>f</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>x</mi><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mi>b</mi><mi>r</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>b</mi><mi>t</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>=</mo><mi>j</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>y</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mi>b</mi><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27"> b_h[i,j] =   \sum\limits_{x=j-br}^{j+br} f[i,x]  / (2 \cdot br)   \\
   b_t[i,j] =   \sum\limits_{y=j-br}^{j+br} b_h[y,j]  / (2 \cdot br) </script>
</big></p>

<p>Those two functions are "looping" in a line, producing "one-dimensional blur". Let's see, what total blur corresponds to:</p>

<p><big>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-314" style="width: 36.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.137em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(5.306em, 1030.09em, 11.767em, -999.998em); top: -7.182em; left: 0em;"><span class="mrow" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 30.137em; height: 0px;"><span style="position: absolute; clip: rect(2.124em, 1030.09em, 5.403em, -999.998em); top: -4em; left: 0em;"><span class="msubsup" id="MathJax-Span-316"><span style="display: inline-block; position: relative; width: 0.774em; height: 0px;"><span style="position: absolute; clip: rect(3.185em, 1000.44em, 4.149em, -999.998em); top: -4em; left: 0em;"><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.855em; left: 0.436em;"><span class="mi" id="MathJax-Span-318" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-325" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 2.317em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.629em;"><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.32em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-327"><span class="mrow" id="MathJax-Span-328"><span class="mi" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-331" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-332" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-333" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-334" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.4em, 4.197em, -999.998em); top: -4.964em; left: 0.436em;"><span class="texatom" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-338" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-340" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-341" style="padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.185em, 1000.44em, 4.149em, -999.998em); top: -4em; left: 0em;"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -3.855em; left: 0.436em;"><span class="mi" id="MathJax-Span-343" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-349"><span class="mrow" id="MathJax-Span-350"><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-353" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main; padding-left: 0.243em;">⋅</span><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">b</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main; padding-left: 0.292em;">=</span><span class="munderover" id="MathJax-Span-359" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 2.365em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.677em;"><span class="mo" id="MathJax-Span-360" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.37em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-361"><span class="mrow" id="MathJax-Span-362"><span class="mi" id="MathJax-Span-363" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-364" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-367" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.45em, 4.294em, -999.998em); top: -5.012em; left: 0.436em;"><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mrow" id="MathJax-Span-375" style="padding-left: 0.147em;"><span class="mo" id="MathJax-Span-376" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-377"><span class="munderover" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 2.413em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.677em;"><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.41em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"><span class="mi" id="MathJax-Span-382" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-383" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-387" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.45em, 4.294em, -999.998em); top: -5.012em; left: 0.485em;"><span class="texatom" id="MathJax-Span-388"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-391" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-392" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-393" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-395" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">x</span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-400"><span class="mrow" id="MathJax-Span-401"><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-404" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main; padding-left: 0.243em;">⋅</span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">b</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main;">)</span></span><span class="mo" id="MathJax-Span-409" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="texatom" id="MathJax-Span-410" style="padding-left: 0.147em;"><span class="mrow" id="MathJax-Span-411"><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-414" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main; padding-left: 0.243em;">⋅</span><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">b</span><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(2.269em, 1012.54em, 5.306em, -999.998em); top: -0.721em; left: 0em;"><span class="mspace" id="MathJax-Span-419" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main;">=</span><span class="munderover" id="MathJax-Span-421" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 2.317em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.629em;"><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.32em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-423"><span class="mrow" id="MathJax-Span-424"><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-426" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-427" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-428" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-429" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.4em, 4.197em, -999.998em); top: -4.964em; left: 0.436em;"><span class="texatom" id="MathJax-Span-431"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-434" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-435" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="munderover" id="MathJax-Span-437" style="padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 2.413em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1001.01em, 4.39em, -999.998em); top: -4em; left: 0.677em;"><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.378em, 1002.41em, 4.39em, -999.998em); top: -3.083em; left: 0em;"><span class="texatom" id="MathJax-Span-439"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-442" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-444" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-445" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1001.45em, 4.294em, -999.998em); top: -5.012em; left: 0.485em;"><span class="texatom" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="mi" id="MathJax-Span-449" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-456" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">x</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main;">]</span><span class="texatom" id="MathJax-Span-459"><span class="mrow" id="MathJax-Span-460"><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-462" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-463" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Main; padding-left: 0.243em;">⋅</span><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">b</span><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-italic;">r</span><span class="msubsup" id="MathJax-Span-467"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.088em, 1000.29em, 4.39em, -999.998em); top: -4em; left: 0em;"><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span><span style="position: absolute; top: -4.385em; left: 0.388em;"><span class="mn" id="MathJax-Span-469" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -5.378em; border-left: 0px solid; width: 0px; height: 7.525em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>t</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>=</mo><mi>i</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>y</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mi>b</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>=</mo><mi>j</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><mrow><mo>(</mo><mrow><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mi>j</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><mi>f</mi><mo stretchy="false">[</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mi>b</mi><mi>r</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mi>b</mi><mi>r</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo>=</mo><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mo>=</mo><mi>i</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><munderover><mo movablelimits="false">∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>=</mo><mi>j</mi><mo>−</mo><mi>b</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>+</mo><mi>b</mi><mi>r</mi></mrow></munderover><mi>f</mi><mo stretchy="false">[</mo><mi>y</mi><mo>,</mo><mi>x</mi><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mi>b</mi><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-28">b_t[i,j] =   \sum\limits_{y=i-br}^{i+br} b_h[y,j]  / (2 \cdot br)   
            =   \sum\limits_{y=j-br}^{j+br} \left(   \sum\limits_{x=j-br}^{j+br} f[y,x]  / (2 \cdot br)   \right)  / (2 \cdot br) \\
            =   \sum\limits_{y=i-br}^{i+br}  \sum\limits_{x=j-br}^{j+br} f[y,x]  / (2 \cdot br)^2  </script>
</big></p>

<p>We just discovered, that our total blur is a box blur! Both total blur and horizontal blur have a complexity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-470" style="width: 4.054em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.359em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1003.24em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-471"><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">r</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-29">O(n \cdot r)</script>, so the whole box blur has <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-478" style="width: 4.054em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.359em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1003.24em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-479"><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-483" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">r</span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">O(n \cdot r)</script>.</p>

<pre name="dlhl" class="DlHighlight js"><span class="operand keyword">function</span> <span class="operand defun">gaussBlur_3</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">var</span> <span class="operand">bxs</span> <span class="operator">=</span> <span class="operand">boxesForGauss</span><span class="paren">(</span><span class="operand">r</span><span class="comma">,</span> <span class="operand">3</span><span class="paren">)</span>;
    <span class="operand">boxBlur_3</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">0</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
    <span class="operand">boxBlur_3</span> <span class="paren">(</span><span class="operand">tcl</span><span class="comma">,</span> <span class="operand">scl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">1</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
    <span class="operand">boxBlur_3</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">2</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
<span class="paren">}</span>
<span class="operand keyword">function</span> <span class="operand defun">boxBlur_3</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">scl</span>.<span class="operand">length</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span> <span class="operand">tcl</span><span class="paren">[</span><span class="operand">i</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">i</span><span class="paren">]</span>;
    <span class="operand">boxBlurH_3</span><span class="paren">(</span><span class="operand">tcl</span><span class="comma">,</span> <span class="operand">scl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span>;
    <span class="operand">boxBlurT_3</span><span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span>;
<span class="paren">}</span>
<span class="operand keyword">function</span> <span class="operand defun">boxBlurH_3</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">h</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span>
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">w</span>; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span>  <span class="paren">{</span>
            <span class="operand keyword">var</span> <span class="operand">val</span> <span class="operator">=</span> <span class="operand">0</span>;
            <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">ix</span><span class="operator">=</span><span class="operand">j</span><span class="operator">-</span><span class="operand">r</span>; <span class="operand">ix</span><span class="operator">&lt;</span><span class="operand">j</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span>; <span class="operand">ix</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
                <span class="operand keyword">var</span> <span class="operand">x</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">min</span><span class="paren">(</span><span class="operand">w</span><span class="operator">-</span><span class="operand">1</span><span class="comma">,</span> <span class="operand builtin">Math</span>.<span class="operand">max</span><span class="paren">(</span><span class="operand">0</span><span class="comma">,</span> <span class="operand">ix</span><span class="paren">)</span><span class="paren">)</span>;
                <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">i</span><span class="operator">*</span><span class="operand">w</span><span class="operator">+</span><span class="operand">x</span><span class="paren">]</span>;
            <span class="paren">}</span>
            <span class="operand">tcl</span><span class="paren">[</span><span class="operand">i</span><span class="operator">*</span><span class="operand">w</span><span class="operator">+</span><span class="operand">j</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand">val</span><span class="operator">/</span><span class="paren">(</span><span class="operand">r</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span>;
        <span class="paren">}</span>
<span class="paren">}</span>   
<span class="operand keyword">function</span> <span class="operand defun">boxBlurT_3</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">h</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span>
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">w</span>; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
            <span class="operand keyword">var</span> <span class="operand">val</span> <span class="operator">=</span> <span class="operand">0</span>;
            <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">iy</span><span class="operator">=</span><span class="operand">i</span><span class="operator">-</span><span class="operand">r</span>; <span class="operand">iy</span><span class="operator">&lt;</span><span class="operand">i</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span>; <span class="operand">iy</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
                <span class="operand keyword">var</span> <span class="operand">y</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">min</span><span class="paren">(</span><span class="operand">h</span><span class="operator">-</span><span class="operand">1</span><span class="comma">,</span> <span class="operand builtin">Math</span>.<span class="operand">max</span><span class="paren">(</span><span class="operand">0</span><span class="comma">,</span> <span class="operand">iy</span><span class="paren">)</span><span class="paren">)</span>;
                <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">y</span><span class="operator">*</span><span class="operand">w</span><span class="operator">+</span><span class="operand">j</span><span class="paren">]</span>;
            <span class="paren">}</span>
            <span class="operand">tcl</span><span class="paren">[</span><span class="operand">i</span><span class="operator">*</span><span class="operand">w</span><span class="operator">+</span><span class="operand">j</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand">val</span><span class="operator">/</span><span class="paren">(</span><span class="operand">r</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span>;
        <span class="paren">}</span>
<span class="paren">}</span></pre>

<h2>Algorithm 4</h2>

<p>One-dimensional blur can be computed even faster. E. g. we want to compute horizontal blur. We compute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-486" style="width: 17.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.181em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1014.12em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-487"><span class="msubsup" id="MathJax-Span-488"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-489" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.817em; left: 0.408em;"><span class="mi" id="MathJax-Span-490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-492" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-493" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-496" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-497" style="padding-left: 0.177em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-498" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.817em; left: 0.408em;"><span class="mi" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-502" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-504" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mn" id="MathJax-Span-505" style="font-family: MathJax_Main; padding-left: 0.234em;">1</span><span class="mo" id="MathJax-Span-506" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-508" style="padding-left: 0.177em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.817em; left: 0.408em;"><span class="mi" id="MathJax-Span-510" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mn" id="MathJax-Span-516" style="font-family: MathJax_Main; padding-left: 0.234em;">2</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main; padding-left: 0.177em;">.</span><span class="mo" id="MathJax-Span-520" style="font-family: MathJax_Main; padding-left: 0.177em;">.</span><span class="mo" id="MathJax-Span-521" style="font-family: MathJax_Main; padding-left: 0.177em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>,</mo><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>,</mo><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>+</mo><mn>2</mn><mo stretchy="false">]</mo><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">b_h[i,j], b_h[i,j+1], b_h[i,j+2], ...</script>. But the neighboring values <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-522" style="width: 3.302em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.723em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1002.61em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-523"><span class="msubsup" id="MathJax-Span-524"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-525" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.817em; left: 0.408em;"><span class="mi" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">b_h[i,j]</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-532" style="width: 5.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.459em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1004.34em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-533"><span class="msubsup" id="MathJax-Span-534"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.817em; left: 0.408em;"><span class="mi" id="MathJax-Span-536" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-538" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mn" id="MathJax-Span-542" style="font-family: MathJax_Main; padding-left: 0.234em;">1</span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-33">b_h[i,j+1]</script> are almost the same. The only difference is in one left-most value and one right-most value. So 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-544" style="width: 24.945em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.778em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1020.66em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-545"><span class="msubsup" id="MathJax-Span-546"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.817em; left: 0.408em;"><span class="mi" id="MathJax-Span-548" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-552" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mn" id="MathJax-Span-554" style="font-family: MathJax_Main; padding-left: 0.234em;">1</span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main; padding-left: 0.292em;">=</span><span class="msubsup" id="MathJax-Span-557" style="padding-left: 0.292em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.817em; left: 0.408em;"><span class="mi" id="MathJax-Span-559" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-565" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-569" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-570" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-571" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">r</span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main; padding-left: 0.234em;">+</span><span class="mn" id="MathJax-Span-574" style="font-family: MathJax_Main; padding-left: 0.234em;">1</span><span class="mo" id="MathJax-Span-575" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main; padding-left: 0.234em;">−</span><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.061em;"></span></span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math-italic; padding-left: 0.177em;">j</span><span class="mo" id="MathJax-Span-582" style="font-family: MathJax_Main; padding-left: 0.234em;">−</span><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">r</span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>f</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>+</mo><mi>r</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>−</mo><mi>f</mi><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>−</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-34">b_h[i,j+1] = b_h[i,j] + f[i,j+r+1] - f[i,j-r]</script>.
</p>

<p>In our new algorithm, we will compute the one-dimensional blur by creating the <strong>accumulator</strong>. First, we put the value of left-most cell into it. Then we will compute next values just by editing the previous value in constant time. This 1D blur has the complexity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-585" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.144em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1002.03em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-588" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-590" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-35">O(n)</script> (independent on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-591" style="width: 0.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.466em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.45em, 1000.47em, 2.26em, -999.997em); top: -2.08em; left: 0em;"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.066em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">r</script>). But it is performed twice to get box blur, which is performed 3 times to get gaussian blur. So the complexity of this gaussian blur is 6 * <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-594" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.144em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1002.03em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-595"><span class="mi" id="MathJax-Span-596" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-599" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-37">O(n)</script>.</p>

<pre name="dlhl" class="DlHighlight js"><span class="operand keyword">function</span> <span class="operand defun">gaussBlur_4</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">var</span> <span class="operand">bxs</span> <span class="operator">=</span> <span class="operand">boxesForGauss</span><span class="paren">(</span><span class="operand">r</span><span class="comma">,</span> <span class="operand">3</span><span class="paren">)</span>;
    <span class="operand">boxBlur_4</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">0</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
    <span class="operand">boxBlur_4</span> <span class="paren">(</span><span class="operand">tcl</span><span class="comma">,</span> <span class="operand">scl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">1</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
    <span class="operand">boxBlur_4</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="paren">(</span><span class="operand">bxs</span><span class="paren">[</span><span class="operand">2</span><span class="paren">]</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="operator">/</span><span class="operand">2</span><span class="paren">)</span>;
<span class="paren">}</span>
<span class="operand keyword">function</span> <span class="operand defun">boxBlur_4</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">scl</span>.<span class="operand">length</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span> <span class="operand">tcl</span><span class="paren">[</span><span class="operand">i</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">i</span><span class="paren">]</span>;
    <span class="operand">boxBlurH_4</span><span class="paren">(</span><span class="operand">tcl</span><span class="comma">,</span> <span class="operand">scl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span>;
    <span class="operand">boxBlurT_4</span><span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span>;
<span class="paren">}</span>
<span class="operand keyword">function</span> <span class="operand defun">boxBlurH_4</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">var</span> <span class="operand">iarr</span> <span class="operator">=</span> <span class="operand">1</span> <span class="operator">/</span> <span class="paren">(</span><span class="operand">r</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span>;
    <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">h</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
        <span class="operand keyword">var</span> <span class="operand">ti</span> <span class="operator">=</span> <span class="operand">i</span><span class="operator">*</span><span class="operand">w</span><span class="comma">,</span> <span class="operand">li</span> <span class="operator">=</span> <span class="operand">ti</span><span class="comma">,</span> <span class="operand">ri</span> <span class="operator">=</span> <span class="operand">ti</span><span class="operator">+</span><span class="operand">r</span>;
        <span class="operand keyword">var</span> <span class="operand">fv</span> <span class="operator">=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ti</span><span class="paren">]</span><span class="comma">,</span> <span class="operand">lv</span> <span class="operator">=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ti</span><span class="operator">+</span><span class="operand">w</span><span class="operator">-</span><span class="operand">1</span><span class="paren">]</span><span class="comma">,</span> <span class="operand">val</span> <span class="operator">=</span> <span class="paren">(</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span><span class="operator">*</span><span class="operand">fv</span>;
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">r</span>; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ti</span><span class="operator">+</span><span class="operand">j</span><span class="paren">]</span>;
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">0</span>  ; <span class="operand">j</span><span class="operator">&lt;=</span><span class="operand">r</span> ; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span> <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ri</span><span class="operator">++</span><span class="paren">]</span> <span class="operator">-</span> <span class="operand">fv</span>       ;   <span class="operand">tcl</span><span class="paren">[</span><span class="operand">ti</span><span class="operator">++</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">round</span><span class="paren">(</span><span class="operand">val</span><span class="operator">*</span><span class="operand">iarr</span><span class="paren">)</span>; <span class="paren">}</span>
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">w</span><span class="operator">-</span><span class="operand">r</span>; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span> <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ri</span><span class="operator">++</span><span class="paren">]</span> <span class="operator">-</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">li</span><span class="operator">++</span><span class="paren">]</span>;   <span class="operand">tcl</span><span class="paren">[</span><span class="operand">ti</span><span class="operator">++</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">round</span><span class="paren">(</span><span class="operand">val</span><span class="operator">*</span><span class="operand">iarr</span><span class="paren">)</span>; <span class="paren">}</span>
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">w</span><span class="operator">-</span><span class="operand">r</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">w</span>  ; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span> <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">lv</span>        <span class="operator">-</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">li</span><span class="operator">++</span><span class="paren">]</span>;   <span class="operand">tcl</span><span class="paren">[</span><span class="operand">ti</span><span class="operator">++</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">round</span><span class="paren">(</span><span class="operand">val</span><span class="operator">*</span><span class="operand">iarr</span><span class="paren">)</span>; <span class="paren">}</span>
    <span class="paren">}</span>
<span class="paren">}</span>
<span class="operand keyword">function</span> <span class="operand defun">boxBlurT_4</span> <span class="paren">(</span><span class="operand">scl</span><span class="comma">,</span> <span class="operand">tcl</span><span class="comma">,</span> <span class="operand">w</span><span class="comma">,</span> <span class="operand">h</span><span class="comma">,</span> <span class="operand">r</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="operand keyword">var</span> <span class="operand">iarr</span> <span class="operator">=</span> <span class="operand">1</span> <span class="operator">/</span> <span class="paren">(</span><span class="operand">r</span><span class="operator">+</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span>;
    <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">i</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">i</span><span class="operator">&lt;</span><span class="operand">w</span>; <span class="operand">i</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span>
        <span class="operand keyword">var</span> <span class="operand">ti</span> <span class="operator">=</span> <span class="operand">i</span><span class="comma">,</span> <span class="operand">li</span> <span class="operator">=</span> <span class="operand">ti</span><span class="comma">,</span> <span class="operand">ri</span> <span class="operator">=</span> <span class="operand">ti</span><span class="operator">+</span><span class="operand">r</span><span class="operator">*</span><span class="operand">w</span>;
        <span class="operand keyword">var</span> <span class="operand">fv</span> <span class="operator">=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ti</span><span class="paren">]</span><span class="comma">,</span> <span class="operand">lv</span> <span class="operator">=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ti</span><span class="operator">+</span><span class="operand">w</span><span class="operator">*</span><span class="paren">(</span><span class="operand">h</span><span class="operator">-</span><span class="operand">1</span><span class="paren">)</span><span class="paren">]</span><span class="comma">,</span> <span class="operand">val</span> <span class="operator">=</span> <span class="paren">(</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span><span class="paren">)</span><span class="operator">*</span><span class="operand">fv</span>;
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">0</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">r</span>; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ti</span><span class="operator">+</span><span class="operand">j</span><span class="operator">*</span><span class="operand">w</span><span class="paren">]</span>;
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">0</span>  ; <span class="operand">j</span><span class="operator">&lt;=</span><span class="operand">r</span> ; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span> <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ri</span><span class="paren">]</span> <span class="operator">-</span> <span class="operand">fv</span>     ;  <span class="operand">tcl</span><span class="paren">[</span><span class="operand">ti</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">round</span><span class="paren">(</span><span class="operand">val</span><span class="operator">*</span><span class="operand">iarr</span><span class="paren">)</span>;  <span class="operand">ri</span><span class="operator">+=</span><span class="operand">w</span>; <span class="operand">ti</span><span class="operator">+=</span><span class="operand">w</span>; <span class="paren">}</span>
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">r</span><span class="operator">+</span><span class="operand">1</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">h</span><span class="operator">-</span><span class="operand">r</span>; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span> <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">ri</span><span class="paren">]</span> <span class="operator">-</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">li</span><span class="paren">]</span>;  <span class="operand">tcl</span><span class="paren">[</span><span class="operand">ti</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">round</span><span class="paren">(</span><span class="operand">val</span><span class="operator">*</span><span class="operand">iarr</span><span class="paren">)</span>;  <span class="operand">li</span><span class="operator">+=</span><span class="operand">w</span>; <span class="operand">ri</span><span class="operator">+=</span><span class="operand">w</span>; <span class="operand">ti</span><span class="operator">+=</span><span class="operand">w</span>; <span class="paren">}</span>
        <span class="operand keyword">for</span><span class="paren">(</span><span class="operand keyword">var</span> <span class="operand">j</span><span class="operator">=</span><span class="operand">h</span><span class="operator">-</span><span class="operand">r</span>; <span class="operand">j</span><span class="operator">&lt;</span><span class="operand">h</span>  ; <span class="operand">j</span><span class="operator">++</span><span class="paren">)</span> <span class="paren">{</span> <span class="operand">val</span> <span class="operator">+=</span> <span class="operand">lv</span>      <span class="operator">-</span> <span class="operand">scl</span><span class="paren">[</span><span class="operand">li</span><span class="paren">]</span>;  <span class="operand">tcl</span><span class="paren">[</span><span class="operand">ti</span><span class="paren">]</span> <span class="operator">=</span> <span class="operand builtin">Math</span>.<span class="operand">round</span><span class="paren">(</span><span class="operand">val</span><span class="operator">*</span><span class="operand">iarr</span><span class="paren">)</span>;  <span class="operand">li</span><span class="operator">+=</span><span class="operand">w</span>; <span class="operand">ti</span><span class="operator">+=</span><span class="operand">w</span>; <span class="paren">}</span>
    <span class="paren">}</span>
<span class="paren">}</span></pre>


<a name="results"></a><h2>Results</h2>

<p>I was testing all 4 algorithms on an image below (4 channels, 800x200 pixels). Here are the results:</p>

<table>
<tbody><tr> <th>Algorithm</th> <th>Time, r=5</th> <th>Time, r=10</th> <th>Time complexity</th></tr>
<tr> <td>Algorithm 1</td> <td>7 077 ms</td> <td>27 021 ms</td> <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-600" style="width: 4.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.764em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em, 1003.65em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-601"><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-603" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-604" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-605" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="msubsup" id="MathJax-Span-606" style="padding-left: 0.234em;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.359em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.337em; left: 0.466em;"><span class="mn" id="MathJax-Span-608" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.462em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><msup><mi>r</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-38">O(n \cdot r^2)</script></td></tr>
<tr> <td>Algorithm 1 (pre-computed weight)</td> <td>2 452 ms</td> <td>8 990 ms</td> <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-610" style="width: 4.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.764em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em, 1003.65em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-611"><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-613" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-614" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="msubsup" id="MathJax-Span-616" style="padding-left: 0.234em;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.359em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.337em; left: 0.466em;"><span class="mn" id="MathJax-Span-618" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-619" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.462em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><msup><mi>r</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">O(n \cdot r^2)</script></td></tr>
<tr> <td>Algorithm 2</td> <td>586 ms</td> <td>2 437 ms</td><td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-620" style="width: 4.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.764em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.16em, 1003.65em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-621"><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="msubsup" id="MathJax-Span-626" style="padding-left: 0.234em;"><span style="display: inline-block; position: relative; width: 0.871em; height: 0px;"><span style="position: absolute; clip: rect(3.359em, 1000.41em, 4.17em, -999.997em); top: -3.99em; left: 0em;"><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.337em; left: 0.466em;"><span class="mn" id="MathJax-Span-628" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-629" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.462em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><msup><mi>r</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">O(n \cdot r^2)</script></td></tr>
<tr> <td>Algorithm 3</td> <td>230 ms</td> <td>435 ms</td><td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-630" style="width: 4.054em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.359em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1003.24em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-631"><span class="mi" id="MathJax-Span-632" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-633" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.234em;">⋅</span><span class="mi" id="MathJax-Span-636" style="font-family: MathJax_Math-italic; padding-left: 0.234em;">r</span><span class="mo" id="MathJax-Span-637" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-41">O(n \cdot r)</script></td></tr>
<tr> <td>Algorithm 4</td> <td>32 ms</td> <td>34 ms</td><td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-638" style="width: 2.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.144em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.218em, 1002.03em, 2.549em, -999.997em); top: -2.138em; left: 0em;"><span class="mrow" id="MathJax-Span-639"><span class="mi" id="MathJax-Span-640" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-641" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-642" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.144em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.344em; border-left: 0px solid; width: 0px; height: 1.323em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">O(n)</script></td></tr>
</tbody></table>

<p>Note, that Alg 1 is computing the true Gaussian blur using gaussian kernel, while Alg 2,3,4 are only approximating it with 3 passes of box blur. The difference between Alg 2,3,4 is in complexity of computing box blur, their outputs are the same.</p>

<p><strong>Original image</strong></p>
<img src="./Fastest Gaussian Blur (in linear time)_files/cballs.png" class="postimg">

<p><strong>Perfect Gaussian Blur (Algorithm 1)</strong></p>
<img src="./Fastest Gaussian Blur (in linear time)_files/cballs_a1_5.png" class="postimg">

<p><strong>Algorithm 2, 3, 4</strong>, average error per pixel: 0.04 %</p>
<img src="./Fastest Gaussian Blur (in linear time)_files/cballs_a4_5.png" class="postimg">

<p><strong>Blur by Adobe Photoshop</strong>, average error per pixel: 0.09%</p>
<img src="./Fastest Gaussian Blur (in linear time)_files/cballs_ps_5.png" class="postimg">							</div>

        	</div>
	    
    <div id="disqus_thread"><iframe id="dsq-app1145" name="dsq-app1145" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Fastest Gaussian Blur (in linear time)_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 8221px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
    <script type="text/javascript">
        var disqus_shortname = 'blog-ivank-net'; // required: replace example with your forum shortname
        (function() {  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })();
    </script>

    <h2>Old comments (closed because of spam)</h2>


	
	 	
	</div>
		<div id="sidebar">
		
		<ul>
		
		<iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="twitter-follow-button twitter-follow-button-rendered" style="position: static; visibility: visible; width: 157px; height: 28px;" title="Twitter Follow Button" src="./Fastest Gaussian Blur (in linear time)_files/follow_button.6e189c4f2b6d88c453045806323cdcf3.en.html" data-screen-name="ivankutskir"></iframe>
		<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id))
		{js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
		
		<a href="http://games.ivank.net/">License HTML5 games</a>
		</ul>


		<h3>My projects</h3>				
		
		<ul>
			<li><a href="http://lib.ivank.net/">IvanK.js</a></li>
			<li><a href="http://polyk.ivank.net/">PolyK.js</a></li>
			<li><a href="http://k3d.ivank.net/">K3D.js</a></li>
			<li><a href="http://www.photopea.com/" title="Photoshop online">Photopea photo editor</a></li>
			<li><a href="http://www.spreadmygame.com/">Spread My Game</a></li>
			<li><a href="http://g.ivank.net/">Graph drawer</a></li>
			<li><a href="http://www.musicpug.com/">Music Pug</a></li>
		</ul>
		
		
		
		<ul>
		<form name="_xclick" action="https://www.paypal.com/cgi-bin/webscr" method="post">
		<input type="hidden" name="cmd" value="_xclick">
		<input type="hidden" name="business" value="ivan@kuckir.com">
		<input type="hidden" name="item_name" value="Blog.ivank.net">
		<input type="hidden" name="currency_code" value="USD">
		<input type="image" src="./Fastest Gaussian Blur (in linear time)_files/btn_donate_LG.gif" name="submit" alt="Donate">
		</form>
		
		<p style="font-size:0.8em">Did you find here anything, what saved your time or money? Make a donation!</p>
		<p style="font-size:0.8em">All code that you see here is free to use, under <strong>MIT licence</strong>.</p>
		</ul>
		

		<h3>Sponsors</h3>
		<div style="text-align:center">
		<!---->
		<script async="" src="./Fastest Gaussian Blur (in linear time)_files/f.txt"></script>
		<ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-0885095539348241" data-ad-slot="2845328934"></ins>
		<script> (adsbygoogle = window.adsbygoogle || []).push({}); </script>
		</div>

		<h3>Visitors</h3>		
		<div style="text-align:center">
		<a href="http://s09.flagcounter.com/more/n4wm">
		<img src="./Fastest Gaussian Blur (in linear time)_files/saved_resource" alt="free counters"></a> </div>
	</div></div>
    
	<div id="footer"> © 2010 - 2021 Ivan Kutskir</div>

</div><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./Fastest Gaussian Blur (in linear time)_files/widget_iframe.6e189c4f2b6d88c453045806323cdcf3.html" title="Twitter settings iframe" style="display: none;"></iframe><iframe style="display: none;" src="./Fastest Gaussian Blur (in linear time)_files/saved_resource(1).html"></iframe><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./Fastest Gaussian Blur (in linear time)_files/saved_resource(2).html"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size4, sans-serif;"></div></div></body></html>